<view class="tutorial-container">
  <!-- é¡¶éƒ¨å›ºå®šï¼šåŠ©æ‰‹ä¿¡æ¯ -->
  <view class="assistant-header">
    <image src="/images/bread-assistant.png" class="assistant-avatar"/>
    <view class="assistant-info">
      <view class="assistant-desc">é¢åŒ…åˆ¶ä½œä¸“å®¶</view>
    </view>
    <view class="header-actions">
      <view class="model-status">
        <text class="model-name">é¢åŒ…åŠ©æ‰‹AI</text>
      </view>
      <!-- æ”¶è—æŒ‰é’®ï¼Œä»…å½“æœ‰é€‰ä¸­çš„é¢åŒ…æ—¶æ˜¾ç¤º -->
      <view class="favorite-btn {{isFavorite ? 'active' : ''}}" wx:if="{{currentBread}}" bindtap="toggleFavorite">
        <text class="favorite-icon">{{isFavorite ? 'â¤' : 'â™¡'}}</text>
      </view>
      <!-- åˆ·æ–°æŒ‰é’® -->
      <view class="refresh-btn" bindtap="resetConversation">
        <image src="/images/refresh.png" class="refresh-icon"/>
      </view>
    </view>
  </view>

  <!-- å½“å‰é¢åŒ…æç¤º -->
  <view class="current-bread-container" wx:if="{{currentBread}}">
    <view class="current-bread-label">å½“å‰é¢åŒ…: {{currentBread}}</view>
    <view class="favorite-status" bindtap="toggleFavorite">
      <text class="favorite-text">{{isFavorite ? 'å·²æ”¶è—' : 'æ”¶è—'}}</text>
      <text class="favorite-heart">{{isFavorite ? 'â¤' : 'â™¡'}}</text>
    </view>
  </view>

  <!-- ä¸­é—´æ»šåŠ¨ï¼šèŠå¤©è®°å½• -->
  <scroll-view class="chat-scroll-container" scroll-y="true" scroll-into-view="{{'scroll-to-bottom'}}" scroll-with-animation="true">    
    <!-- èŠå¤©æ¶ˆæ¯ -->
    <block wx:for="{{messages}}" wx:key="id">
      <!-- æœºå™¨äººæ¶ˆæ¯ -->
      <block wx:if="{{item.type==='bot'}}">
        <view class="msg bot">
          <image src="/images/bread-assistant.png" class="msg-avatar"/>
          <view class="msg-content-wrapper">
            <view class="msg-content bot-msg-content">{{item.content}}</view>
          </view>
        </view>
      </block>
      
      <!-- ç”¨æˆ·æ¶ˆæ¯ -->
      <block wx:if="{{item.type==='user'}}">
        <view class="msg user">
          <view class="msg-content-wrapper">
            <view class="msg-content user-msg-content">{{item.content}}</view>
          </view>
        </view>
        <view class="user-time">{{item.timeString}}</view>
      </block>
    </block>
    
    <!-- åŠ è½½ä¸­æç¤º -->
    <view class="msg bot" wx:if="{{isLoading}}">
      <image src="/images/bread-assistant.png" class="msg-avatar"/>
      <view class="msg-content-wrapper">
        <view class="msg-content bot-msg-content loading">
          <view class="bread-loading">
            <view class="bread-loading-icon"></view>
            <text class="bread-loading-text">çƒ˜ç„™ä¸­...</text>
          </view>
        </view>
      </view>
    </view>
    
    <!-- ç©ºç™½è§†å›¾ï¼Œç”¨äºæ»šåŠ¨åˆ°åº•éƒ¨ -->
    <view id="scroll-to-bottom"></view>
  </scroll-view>

  <!-- åº•éƒ¨å›ºå®šï¼šè¾“å…¥åŒºåŸŸ -->
  <view class="input-area">
    <view class="input-wrapper">
      <input class="msg-input" placeholder="è¾“å…¥ä½ æƒ³é—®çš„é—®é¢˜..." placeholder-style="color: #A99D95;" value="{{inputMsg}}" bindinput="onInput" bindconfirm="sendMsg" confirm-type="send"/>
      <button style="width: 80px;" class="send-btn" bindtap="sendMsg" disabled="{{!inputMsg || isLoading}}">
        <text class="send-icon">å‘é€</text>
      </button>
    </view>
    
    <!-- å¿«æ·é—®é¢˜æŒ‰é’® -->
    <view class="quick-questions" wx:if="{{messages.length > 0}}">
      <scroll-view scroll-x="true" class="quick-scroll" show-scrollbar="false">
        <!-- å¦‚æœæœ‰å½“å‰é¢åŒ…ï¼Œæ˜¾ç¤ºç›¸å…³é—®é¢˜ -->
        <block wx:if="{{currentBread}}">
          <button class="quick-btn" bindtap="quickInput" data-text="{{currentBread}}éœ€è¦å“ªäº›ææ–™ï¼Ÿ">
            <text class="quick-btn-icon">ğŸ§¾</text> æ‰€éœ€ææ–™
          </button>
          <button class="quick-btn" bindtap="quickInput" data-text="{{currentBread}}çš„çƒ˜ç„™æ¸©åº¦å’Œæ—¶é—´æ˜¯å¤šå°‘ï¼Ÿ">
            <text class="quick-btn-icon">ğŸ”¥</text> çƒ˜ç„™æ—¶é—´
          </button>
          <button class="quick-btn" bindtap="quickInput" data-text="{{currentBread}}æœ‰ä»€ä¹ˆå°æŠ€å·§å—ï¼Ÿ">
            <text class="quick-btn-icon">ğŸ’¡</text> åˆ¶ä½œæŠ€å·§
          </button>
        </block>
        <!-- é»˜è®¤é—®é¢˜ -->
        <block wx:else>
          <button class="quick-btn" bindtap="quickInput" data-text="é¢åŒ…å‘é…µæŠ€å·§">
            <text class="quick-btn-icon">ğŸ</text> é¢åŒ…å‘é…µæŠ€å·§
          </button>
          <button class="quick-btn" bindtap="quickInput" data-text="çƒ˜ç„™æ¸©åº¦æ§åˆ¶">
            <text class="quick-btn-icon">ğŸ”¥</text> çƒ˜ç„™æ¸©åº¦æ§åˆ¶
          </button>
        </block>
      </scroll-view>
    </view>
  </view>
</view> 